





/*
--used to load demographics into raw demographics tables
--DBCC CHECKIDENT ('rawdata.dbo.demographics', reseed, 0)

--delete from rawdata.dbo.demographics

insert into rawdata.dbo.demographics (year,fips,variable,value)

SELECT distinct 2013 as year, fips, variable, value
FROM 
(
   SELECT 
fips,
LATITUDE,
LONGITUDE,
POPCY,
RACCYWHITE,
RACCYBLACK,
RACCYAMIND,
RACCYASIAN,
RACCYHAWAI,
RACCYOTHER,
RACCYMULT,
HISCYHISP,
SEXCYMAL,
SEXCYFEM,
AGECY0004,
AGECY0509,
AGECY1019,
AGECY2029,
AGECY3039,
AGECY4049,
AGECY5059,
AGECY6064,
AGECYGT65,
MARCYNEVER,
MARCYMARR,
MARCYSEP,
MARCYWIDOW,
MARCYDIVOR,
AGECYGT25,
EDUCYLTGR9,
EDUCYSHSCH,
EDUCYHSCH,
EDUCYSCOLL,
EDUCYASSOC,
EDUCYBACH,
EDUCYGRAD,
LBFCYEMPL,
LBFCYUNEM,
LBFCYARM,
LBFCYNLF,
LBFCYLBF2,
LBFCYLBF,
UNECYRATE,
HHDCY,
HHDCYFAM,
HHDCYNFM,
HHDCYS1,
HHDCYS2,
HHDCYS3,
HHDCYS4,
HHDCYS5,
HHDCYS6,
HINCYLT10,
HINCY1020,
HINCY2030,
HINCY3040,
HINCY4050,
HINCY5060,
HINCY6075,
HINCY75100,
HINCYGT100,
DWLCY,
DWLCYOWNED,
DWLCYRENT,
DWLCYVACNT,
DWLCYOCCUP,
INCCYAGG,
INCCYPCAP,
INCCYMEDHH,
WRHCYAVEHH,
WRHCYAGG,
AGECYMED,
POPPY,
RACPYWHITE,
RACPYBLACK,
RACPYAMIND,
RACPYASIAN,
RACPYHAWAI,
RACPYOTHER,
RACPYMULT,
HISPYHISP,
SEXPYMAL,
SEXPYFEM,
AGEPY0004,
AGEPY0509,
AGEPY1019,
AGEPY2029,
AGEPY3039,
AGEPY4049,
AGEPY5059,
AGEPY6064,
AGEPYGT65,
MARPYNEVER,
MARPYMARR,
MARPYSEP,
MARPYWIDOW,
MARPYDIVOR,
AGEPYGT25,
EDUPYLTGR9,
EDUPYSHSCH,
EDUPYHSCH,
EDUPYSCOLL,
EDUPYASSOC,
EDUPYBACH,
EDUPYGRAD,
LBFPYEMPL,
LBFPYUNEM,
LBFPYARM,
LBFPYNLF,
LBFPYLBF,
LBFPYLBF2,
UNEPYRATE,
HHDPY,
HHDPYFAM,
HHDPYNFM,
HHDPYS1,
HHDPYS2,
HHDPYS3,
HHDPYS4,
HHDPYS5,
HHDPYS6,
HINPYLT10,
HINPY1020,
HINPY2030,
HINPY3040,
HINPY4050,
HINPY5060,
HINPY6075,
HINPY75100,
HINPYGT100,
DWLPY,
DWLPYOWNED,
DWLPYRENT,
DWLPYVACNT,
DWLPYOCCUP,
INCPYAGG,
INCPYAGGDI,
HHDPYAVESZ,
INCPYPCAP,
INCPYMEDHH,
AGEPYMED,
INCCYAGGDI,
BUSCYEST,
BUSCYEMP,
ESZCYA,
ESZCYB,
ESZCYC,
ESZCYD,
ESZCYE,
ESZCYF,
ESZCYG,
ESZCYH,
ESZCYI,
ESTCYAFF,
ESTCYAGRSV,
ESTCYCOALM,
ESTCYOIL,
ESTCYGCON,
ESTCYHCON,
ESTCYMFOOD,
ESTCYMTOB,
ESTCYMTXT,
ESTCYMAPP,
ESTCYMWOOD,
ESTCYMFURN,
ESTCYMPAPR,
ESTCYMPUBL,
ESTCYMCHEM,
ESTCYMPETL,
ESTCYMRUBB,
ESTCYMLTHR,
ESTCYMSTN,
ESTCYMMFAB,
ESTCYMEQMT,
ESTCYTRNSP,
ESTCYTRAV,
ESTCYTRANV,
ESTCYCOMM,
ESTCYUTIL,
ESTCYWHLD,
ESTCYWHLND,
ESTCYRBMAT,
ESTCYRGMER,
ESTCYRFOOD,
ESTCYRCONV,
ESTCYROFD,
ESTCYRAUTO,
ESTCYRCLTH,
ESTCYRFURN,
ESTCYRHFRN,
ESTCYRCOMP,
ESTCYRMUS,
ESTCYRRST,
ESTCYROFS,
ESTCYRBAR,
ESTCYRDRG,
ESTCYRLIQ,
ESTCYRSPC,
ESTCYRCAT,
ESTCYBANKS,
ESTCYINSCA,
ESTCYINSAG,
ESTCYREAL,
ESTCYHOTEL,
ESTCYDRYCL,
ESTCYBTY,
ESTCYOTHPS,
ESTCYADVER,
ESTCYCOMPS,
ESTCYOTHBS,
ESTCYAREP,
ESTCYMREP,
ESTCYMOVIE,
ESTCYENTRC,
ESTCYHLTHM,
ESTCYHOSP,
ESTCYLEGAL,
ESTCYEDUC,
ESTCYCOLL,
ESTCYSOCSR,
ESTCYCHILD,
ESTCYMUSMS,
ESTCYMEMBO,
ESTCYPROFS,
ESTCYGOVT,
ESTCYUNK,
BCCCYEXEC,
BCCCYBFIN,
BCCCYCOMP,
BCCCYENGR,
BCCCYSCNC,
BCCCYCSRV,
BCCCYLEGL,
BCCCYEDUC,
BCCCYARTS,
BCCCYHLTH,
BCCCYHTCH,
BCCCYHCSP,
BCCCYPROT,
BCCCYFOOD,
BCCCYBGMT,
BCCCYPCAR,
BCCCYSALE,
BCCCYOFFC,
BCCCYPRIM,
BCCCYCONS,
BCCCYMREP,
BCCCYPROD,
BCCCYTRAN,
BCCCYMMOV,
BCCCYWHTCL,
EMPCYAGRIC,
EMPCYMINE,
EMPCYCONST,
EMPCYMANUF,
EMPCYTRANS,
EMPCYWTRAD,
EMPCYRTRAD,
EMPCYFIRE,
EMPCYSRV,
EMPCYPUBAD,
EMPCYUNCLA,
EMPCYAFF,
EMPCYAGRSV,
EMPCYCOALM,
EMPCYOIL,
EMPCYGCON,
EMPCYHCON,
EMPCYMFOOD,
EMPCYMTOB,
EMPCYMTXT,
EMPCYMAPP,
EMPCYMWOOD,
EMPCYMFURN,
EMPCYMPAPR,
EMPCYMPUBL,
EMPCYMCHEM,
EMPCYMPETL,
EMPCYMRUBB,
EMPCYMLTHR,
EMPCYMSTN,
EMPCYMMFAB,
EMPCYMEQMT,
EMPCYTRNSP,
EMPCYTRAV,
EMPCYTRANV,
EMPCYCOMM,
EMPCYUTIL,
EMPCYWHLD,
EMPCYWHLND,
EMPCYRBMAT,
EMPCYRGMER,
EMPCYRFOOD,
EMPCYRCONV,
EMPCYROFD,
EMPCYRAUTO,
EMPCYRCLTH,
EMPCYRFURN,
EMPCYRHFRN,
EMPCYRCOMP,
EMPCYRMUS,
EMPCYRRST,
EMPCYROFS,
EMPCYRBAR,
EMPCYRDRG,
EMPCYRLIQ,
EMPCYRSPC,
EMPCYRCAT,
EMPCYBANKS,
EMPCYINSCA,
EMPCYINSAG,
EMPCYREAL,
EMPCYHOTEL,
EMPCYDRYCL,
EMPCYBTY,
EMPCYOTHPS,
EMPCYADVER,
EMPCYCOMPS,
EMPCYOTHBS,
EMPCYAREP,
EMPCYMREP,
EMPCYMOVIE,
EMPCYENTRC,
EMPCYHLTHM,
EMPCYHOSP,
EMPCYLEGAL,
EMPCYEDUC,
EMPCYCOLL,
EMPCYSOCSR,
EMPCYCHILD,
EMPCYMUSMS,
EMPCYMEMBO,
EMPCYPROFS,
EMPCYGOVT,
EMPCYUNK,
TCYCC,
TCYPI,
TCYAP,
TCYAP1,
TCYAP2,
TCYAP3,
TCYAP4,
TCYAP5,
TCYAP6,
TCYAP7,
TCYED,
TCYED1,
TCYED2,
TCYEN,
TCYEN1,
TCYEN2,
TCYEN3,
TCYFB,
TCYFB1,
TCYFB2,
TCYFB3,
TCYHC,
TCYHC1,
TCYHC2,
TCYHC3,
TCYHF,
TCYHF1,
TCYHF2,
TCYHF3,
TCYHF4,
TCYHF5,
TCYHH,
TCYHH1,
TCYHH2,
TCYHH3,
TCYHH4,
TCYHH5,
TCYHO,
TCYHO1,
TCYHO2,
TCYHO3,
TCYHO4,
TCYMI,
TCYMI1,
TCYMI2,
TCYMI3,
TCYMI4,
TCYPC,
TCYPC1,
TCYPC2,
TCYPC3,
TCYPC4,
TCYRD,
TCYRD1,
TCYRD2,
TCYRD3,
TCYTB,
TCYTB1,
TCYTB2,
TCYTR,
TCYTR1,
TCYTR2,
TCYTR3,
TCYTR4,
TCYTR5,
TCYTR6,
TCYTR7,
TCYTR8,
TCYTR9,
TCYUT,
TCYUT1,
TCYUT2,
TCYUT3,
TCYUT4,
TCYUT5,
TCYGI,
TCYGI1,
TCYGI2,
TCYGI3,
TCYGI4,
TCYGI5,
TCYGI6,
TCYGI7,
TCYGI8,
TCYGI9,
TCYHH306,
ESTCYMINE,
ESTCYCONST,
ESTCYMANUF,
ESTCYTRANS,
ESTCYWTRAD,
ESTCYRTRAD,
ESTCYFIRE,
ESTCYSRV,
ESTCYPUBAD,
ESTCYUNCLA,
HISCYNONH,
TCYTOTAL,
XCYTOTAL,
BCCCYBLUCL,
TVW00MED,
TVW00AVE,
TMPAVEANN,
TMPMAXANN,
TMPMINANN,
PREANNRAIN,
PREANNSNOW,
LBFCYPOP16,
LBF00EMP
   FROM demographics.dbo.demographics
) demo
UNPIVOT
   (Value FOR Variable IN 
      (
LATITUDE,
LONGITUDE,
POPCY,
RACCYWHITE,
RACCYBLACK,
RACCYAMIND,
RACCYASIAN,
RACCYHAWAI,
RACCYOTHER,
RACCYMULT,
HISCYHISP,
SEXCYMAL,
SEXCYFEM,
AGECY0004,
AGECY0509,
AGECY1019,
AGECY2029,
AGECY3039,
AGECY4049,
AGECY5059,
AGECY6064,
AGECYGT65,
MARCYNEVER,
MARCYMARR,
MARCYSEP,
MARCYWIDOW,
MARCYDIVOR,
AGECYGT25,
EDUCYLTGR9,
EDUCYSHSCH,
EDUCYHSCH,
EDUCYSCOLL,
EDUCYASSOC,
EDUCYBACH,
EDUCYGRAD,
LBFCYEMPL,
LBFCYUNEM,
LBFCYARM,
LBFCYNLF,
LBFCYLBF2,
LBFCYLBF,
UNECYRATE,
HHDCY,
HHDCYFAM,
HHDCYNFM,
HHDCYS1,
HHDCYS2,
HHDCYS3,
HHDCYS4,
HHDCYS5,
HHDCYS6,
HINCYLT10,
HINCY1020,
HINCY2030,
HINCY3040,
HINCY4050,
HINCY5060,
HINCY6075,
HINCY75100,
HINCYGT100,
DWLCY,
DWLCYOWNED,
DWLCYRENT,
DWLCYVACNT,
DWLCYOCCUP,
INCCYAGG,
INCCYPCAP,
INCCYMEDHH,
WRHCYAVEHH,
WRHCYAGG,
AGECYMED,
POPPY,
RACPYWHITE,
RACPYBLACK,
RACPYAMIND,
RACPYASIAN,
RACPYHAWAI,
RACPYOTHER,
RACPYMULT,
HISPYHISP,
SEXPYMAL,
SEXPYFEM,
AGEPY0004,
AGEPY0509,
AGEPY1019,
AGEPY2029,
AGEPY3039,
AGEPY4049,
AGEPY5059,
AGEPY6064,
AGEPYGT65,
MARPYNEVER,
MARPYMARR,
MARPYSEP,
MARPYWIDOW,
MARPYDIVOR,
AGEPYGT25,
EDUPYLTGR9,
EDUPYSHSCH,
EDUPYHSCH,
EDUPYSCOLL,
EDUPYASSOC,
EDUPYBACH,
EDUPYGRAD,
LBFPYEMPL,
LBFPYUNEM,
LBFPYARM,
LBFPYNLF,
LBFPYLBF,
LBFPYLBF2,
UNEPYRATE,
HHDPY,
HHDPYFAM,
HHDPYNFM,
HHDPYS1,
HHDPYS2,
HHDPYS3,
HHDPYS4,
HHDPYS5,
HHDPYS6,
HINPYLT10,
HINPY1020,
HINPY2030,
HINPY3040,
HINPY4050,
HINPY5060,
HINPY6075,
HINPY75100,
HINPYGT100,
DWLPY,
DWLPYOWNED,
DWLPYRENT,
DWLPYVACNT,
DWLPYOCCUP,
INCPYAGG,
INCPYAGGDI,
HHDPYAVESZ,
INCPYPCAP,
INCPYMEDHH,
AGEPYMED,
INCCYAGGDI,
BUSCYEST,
BUSCYEMP,
ESZCYA,
ESZCYB,
ESZCYC,
ESZCYD,
ESZCYE,
ESZCYF,
ESZCYG,
ESZCYH,
ESZCYI,
ESTCYAFF,
ESTCYAGRSV,
ESTCYCOALM,
ESTCYOIL,
ESTCYGCON,
ESTCYHCON,
ESTCYMFOOD,
ESTCYMTOB,
ESTCYMTXT,
ESTCYMAPP,
ESTCYMWOOD,
ESTCYMFURN,
ESTCYMPAPR,
ESTCYMPUBL,
ESTCYMCHEM,
ESTCYMPETL,
ESTCYMRUBB,
ESTCYMLTHR,
ESTCYMSTN,
ESTCYMMFAB,
ESTCYMEQMT,
ESTCYTRNSP,
ESTCYTRAV,
ESTCYTRANV,
ESTCYCOMM,
ESTCYUTIL,
ESTCYWHLD,
ESTCYWHLND,
ESTCYRBMAT,
ESTCYRGMER,
ESTCYRFOOD,
ESTCYRCONV,
ESTCYROFD,
ESTCYRAUTO,
ESTCYRCLTH,
ESTCYRFURN,
ESTCYRHFRN,
ESTCYRCOMP,
ESTCYRMUS,
ESTCYRRST,
ESTCYROFS,
ESTCYRBAR,
ESTCYRDRG,
ESTCYRLIQ,
ESTCYRSPC,
ESTCYRCAT,
ESTCYBANKS,
ESTCYINSCA,
ESTCYINSAG,
ESTCYREAL,
ESTCYHOTEL,
ESTCYDRYCL,
ESTCYBTY,
ESTCYOTHPS,
ESTCYADVER,
ESTCYCOMPS,
ESTCYOTHBS,
ESTCYAREP,
ESTCYMREP,
ESTCYMOVIE,
ESTCYENTRC,
ESTCYHLTHM,
ESTCYHOSP,
ESTCYLEGAL,
ESTCYEDUC,
ESTCYCOLL,
ESTCYSOCSR,
ESTCYCHILD,
ESTCYMUSMS,
ESTCYMEMBO,
ESTCYPROFS,
ESTCYGOVT,
ESTCYUNK,
BCCCYEXEC,
BCCCYBFIN,
BCCCYCOMP,
BCCCYENGR,
BCCCYSCNC,
BCCCYCSRV,
BCCCYLEGL,
BCCCYEDUC,
BCCCYARTS,
BCCCYHLTH,
BCCCYHTCH,
BCCCYHCSP,
BCCCYPROT,
BCCCYFOOD,
BCCCYBGMT,
BCCCYPCAR,
BCCCYSALE,
BCCCYOFFC,
BCCCYPRIM,
BCCCYCONS,
BCCCYMREP,
BCCCYPROD,
BCCCYTRAN,
BCCCYMMOV,
BCCCYWHTCL,
EMPCYAGRIC,
EMPCYMINE,
EMPCYCONST,
EMPCYMANUF,
EMPCYTRANS,
EMPCYWTRAD,
EMPCYRTRAD,
EMPCYFIRE,
EMPCYSRV,
EMPCYPUBAD,
EMPCYUNCLA,
EMPCYAFF,
EMPCYAGRSV,
EMPCYCOALM,
EMPCYOIL,
EMPCYGCON,
EMPCYHCON,
EMPCYMFOOD,
EMPCYMTOB,
EMPCYMTXT,
EMPCYMAPP,
EMPCYMWOOD,
EMPCYMFURN,
EMPCYMPAPR,
EMPCYMPUBL,
EMPCYMCHEM,
EMPCYMPETL,
EMPCYMRUBB,
EMPCYMLTHR,
EMPCYMSTN,
EMPCYMMFAB,
EMPCYMEQMT,
EMPCYTRNSP,
EMPCYTRAV,
EMPCYTRANV,
EMPCYCOMM,
EMPCYUTIL,
EMPCYWHLD,
EMPCYWHLND,
EMPCYRBMAT,
EMPCYRGMER,
EMPCYRFOOD,
EMPCYRCONV,
EMPCYROFD,
EMPCYRAUTO,
EMPCYRCLTH,
EMPCYRFURN,
EMPCYRHFRN,
EMPCYRCOMP,
EMPCYRMUS,
EMPCYRRST,
EMPCYROFS,
EMPCYRBAR,
EMPCYRDRG,
EMPCYRLIQ,
EMPCYRSPC,
EMPCYRCAT,
EMPCYBANKS,
EMPCYINSCA,
EMPCYINSAG,
EMPCYREAL,
EMPCYHOTEL,
EMPCYDRYCL,
EMPCYBTY,
EMPCYOTHPS,
EMPCYADVER,
EMPCYCOMPS,
EMPCYOTHBS,
EMPCYAREP,
EMPCYMREP,
EMPCYMOVIE,
EMPCYENTRC,
EMPCYHLTHM,
EMPCYHOSP,
EMPCYLEGAL,
EMPCYEDUC,
EMPCYCOLL,
EMPCYSOCSR,
EMPCYCHILD,
EMPCYMUSMS,
EMPCYMEMBO,
EMPCYPROFS,
EMPCYGOVT,
EMPCYUNK,
TCYCC,
TCYPI,
TCYAP,
TCYAP1,
TCYAP2,
TCYAP3,
TCYAP4,
TCYAP5,
TCYAP6,
TCYAP7,
TCYED,
TCYED1,
TCYED2,
TCYEN,
TCYEN1,
TCYEN2,
TCYEN3,
TCYFB,
TCYFB1,
TCYFB2,
TCYFB3,
TCYHC,
TCYHC1,
TCYHC2,
TCYHC3,
TCYHF,
TCYHF1,
TCYHF2,
TCYHF3,
TCYHF4,
TCYHF5,
TCYHH,
TCYHH1,
TCYHH2,
TCYHH3,
TCYHH4,
TCYHH5,
TCYHO,
TCYHO1,
TCYHO2,
TCYHO3,
TCYHO4,
TCYMI,
TCYMI1,
TCYMI2,
TCYMI3,
TCYMI4,
TCYPC,
TCYPC1,
TCYPC2,
TCYPC3,
TCYPC4,
TCYRD,
TCYRD1,
TCYRD2,
TCYRD3,
TCYTB,
TCYTB1,
TCYTB2,
TCYTR,
TCYTR1,
TCYTR2,
TCYTR3,
TCYTR4,
TCYTR5,
TCYTR6,
TCYTR7,
TCYTR8,
TCYTR9,
TCYUT,
TCYUT1,
TCYUT2,
TCYUT3,
TCYUT4,
TCYUT5,
TCYGI,
TCYGI1,
TCYGI2,
TCYGI3,
TCYGI4,
TCYGI5,
TCYGI6,
TCYGI7,
TCYGI8,
TCYGI9,
TCYHH306,
ESTCYMINE,
ESTCYCONST,
ESTCYMANUF,
ESTCYTRANS,
ESTCYWTRAD,
ESTCYRTRAD,
ESTCYFIRE,
ESTCYSRV,
ESTCYPUBAD,
ESTCYUNCLA,
HISCYNONH,
TCYTOTAL,
XCYTOTAL,
BCCCYBLUCL,
TVW00MED,
TVW00AVE,
TMPAVEANN,
TMPMAXANN,
TMPMINANN,
PREANNRAIN,
PREANNSNOW,
LBFCYPOP16,
LBF00EMP
      )
)AS unpvt
where value is not null


*/







