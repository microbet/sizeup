@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}


@section head{
<title>Business Listings</title>
<link href="@Url.Content("~/Content/views/competition/index.css")" rel="stylesheet" type="text/css" />

<script type="text/javascript" src="http://maps.google.com/maps/api/js?key=@System.Configuration.ConfigurationManager.AppSettings["GoogleAPI"]&sensor=false"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/thirdParty/jquery.ba-bbq.min.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/core/data.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/core/notifier.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/thirdParty/mustache.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/core/templates.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/controls/industrySelector.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/controls/pager.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/mapStyles.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/mapOptions.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/map.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/businessMarker.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/imagePin.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/latlng.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/latlngBounds.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/overlay.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/businessMap.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/infoWindow.js")"></script>

<script type="text/javascript" src="@Url.Content("~/Scripts/views/shared/signin.js")"></script>

<script type="text/javascript" src="@Url.Content("~/Scripts/views/competition/competition2.js")"></script>

}

<div id="competition">

    <ul class="questions">
        <li><a href="javascript:void(0);" class="inverse suppliers">Do you BUY from other businesses?</a></li>
        <li><a href="javascript:void(0);" class="inverse buyers">Do you SELL to other businesses?</a></li>
        <li><a href="javascript:void(0);" class="inverse consumers">Do you SELL to consumers?</a></li>
    </ul>

    <div class="content container">
        <div class="controls container">
             <ul class="tabs">
                <li><a href="javascript:void(0);" class="active competitors">Competition</a></li>
                <li><a href="javascript:void(0);" class="suppliers hidden">Suppliers</a></li>
                <li><a href="javascript:void(0);" class="buyers hidden" >Buyers</a></li>
             </ul>

            <div class="mapControls container hidden">
                <div class="mapFilter container">
                    <ul>
                        <li class="competitor">
                            <input type="radio" id="competitorBox" data-index="competitor" name="mapFilter">
                            <label for="competitorBox"><span class="legendItem"></span>Competitors</label>
                        </li>
                        <li class="buyer">
                            <input type="radio" id="buyerBox" data-index="buyer" name="mapFilter">
                            <label for="buyerBox"><span class="legendItem"></span>Customers</label>
                        </li>
                        <li class="supplier">
                            <input type="radio" id="supplierBox" data-index="supplier" name="mapFilter">
                            <label for="supplierBox"><span class="legendItem"></span>Suppliers</label>
                        </li>
                        <li class="all">
                            <input type="radio" id="allBox" data-index="all" name="mapFilter" checked="checked" >
                            <label for="allBox">All <span class="zoomMessage">(Zoom In)</span></label>
                        </li>
                    </ul>
                </div>

                <div class="consumerExpenditures container">
                    <a href="javascript:void(0);" class="menu">Consumer Expenditures</a>
                    <div class="consumerExpenditurePicker hidden">
                        <ul class="selection">
                            <li data-template="consumerExpenditureListItem"><a href="javascript:void(0);" data-id="{{Id}}" class="inverse">{{Description}}</a></li>                  
                        </ul>
                        <ul class="children">
                        </ul>
                        <div class="menuOptions">
                            <a class="inverse startOver" href="javascript:void(0);">Start Over</a> | <a class="inverse close" href="javascript:void(0);">Close</a> 
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="list container">
            <div class="industryPicker container"> 
                <p class="currentIndustry competitor">Your Industry: @ViewBag.CurrentInfo.CurrentIndustry.Name</p>
                <ul class="industryList">
                    <li data-template="industryItem" class="item" data-id="{{Id}}">
                        <a href="javascript:void(0);" class="remove" data-id="{{Id}}">Remove</a>
                        <span title="{{Name}}">{{Name}}</span>
                    </li>
                </ul>
        
                <p class="competitor">Add additional categories of businesses that compete with you:</p>
                <p class="buyer">NEED BUYER TEXT:</p>
                <p class="supplier">NEED SUPPLIER TEXT:</p>
                <input type="text" class="pickerInput" value="enter an industry" />
            </div>

            <div class="loading hidden">
                <p class="title"></p>
                <img src="@Url.Content("~/content/images/Loading.gif")" alt="Loading" />
                <p class="message">Loading Businesses</p>
            </div>

            <div class="noResults hidden">
                <p>There are no businesses that meet your criteria</p>
            </div>

            <div class="addIndustries hidden">
                <p>Add industries to populate this list of businesses</p>
            </div>

            <ul class="businessList hidden">
                <li data-template="businessItem">
                    <a href="javascript:void(0);" data-id="{{business.Id}}">
                        <img data-override-src="/pins/business/marker/competitor/{{index}}" />
                        <dl>
                            <dt class="name">{{business.Name}}</dt>
                            <dd class="address">{{business.Address}}{{^business.Address}}Street address not provided{{/business.Address}}</dd>
                        </dl>
                    </a>
                </li>
            </ul>

            <div class="pager hidden">
                <div data-template="pager">
                    <span class="label">Viewing {{start}}-{{end}} of {{totalItems}}</span>
                    {{#first}}<a href="javascript:void(0);" data-index="first">&lt;&lt;</a>{{/first}}
                    {{#prev}}<a href="javascript:void(0);" data-index="prev">&lt;</a>{{/prev}}
                    <ul>
                        {{#pages}}
                        <li class="page {{#current}}current{{/current}}"><a href="javascript:void(0);" data-index="{{index}}">{{index}}</a></li>
                        {{#seperator}}<li class="seperator">|</li>{{/seperator}}
                        {{/pages}}
                    </ul>
                    {{#next}}<a href="javascript:void(0);" data-index="next">&gt;</a>{{/next}}
                    {{#last}}<a href="javascript:void(0);" data-index="last">&gt;&gt;</a>{{/last}}
                </div>
            </div>

            @if(!HttpContext.Current.User.Identity.IsAuthenticated){
            <div class="signinWrapper hidden">
                    <a href="javascript:void(0);" class="signinToggle inverse" >
                        <span class="prompt">See all {{totalItems}} businesses</span>
                        <span class="viewing">Viewing {{start}}-{{end}} of {{totalItems}}</span>
                    </a>
                    @Html.Partial("Signin")  
            </div>   
            }
        </div>

        <div class="mapWrapper container">
            <div class="legend">
                <p class="title backdrop"></p>
                <div class="legend backdrop">
                    <ul class="legendContainer">
                        <li data-template="legendItem"><div class="block" data-override-style="background-color: {{color}};"></div><span class="range">{{label}}</span></li>
                    </ul>
                    <div class="bottom backdrop"></div>
                </div>
            </div>

            <div data-template="infoWindow" class="infoWindow">
                <h3>{{Name}}</h3>
                <span>{{Address}}{{^Address}}Street address not provided{{/Address}}</span>
                <ul>
                    <li><span class="label">Phone:</span><span class="value">{{PhoneFormatted}}</span></li>
                    <li><span class="label">Business Type:</span><span class="value">{{#IsFirm}}Corporation{{/IsFirm}}{{^IsFirm}}{{#IsHomeBased}}Home-based{{/IsHomeBased}}{{^IsHomeBased}}No data{{/IsHomeBased}}{{/IsFirm}}</span></li>
                    <li><span class="label">Ownership:</span><span class="value">{{#IsPublic}}Public{{/IsPublic}}{{^IsPublic}}Private{{/IsPublic}}</span></li>
                    <li><span class="label">Website:</span>{{#Url}}<a target="_blank" data-override-href="http://{{Url}}" class="value">{{Url}}</a>{{/Url}}{{^Url}}<span class="lowlight value">Not provided</span>{{/Url}}</li>
                    <li><span class="label">Years in business:</span>{{#YearsInBusiness}}<span class="value">{{YearsInBusiness}}</span>{{/YearsInBusiness}}{{^YearsInBusiness}}<span class="value">No data</span>{{/YearsInBusiness}}</li>
                </ul>
                <div class="tools">
                    <a class="zoom" href="javascript:void(0);">Zoom</a>
                    <a class="remove" href="javascript:void(0);">Remove Pin</a>
                </div>
            </div>
            <div class="map"></div>
        </div>
    </div>
</div>



@section scripts{

    <script type="text/javascript">
        var opts = {
            CurrentInfo: @Html.Raw(ViewBag.CurrentInfoJSON) ,
            ConsumerExpenditureVariables: @Html.Raw(ViewBag.ConsumerExpenditureVariablesJSON)
        };
        var driver = new sizeup.views.competition.competition(opts);
    </script>


}


