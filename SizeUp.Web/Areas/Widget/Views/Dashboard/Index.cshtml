@{
    Layout = "~/Areas/Widget/Views/Shared/_Layout.cshtml";
}

@section head{
<title>Business Dashboard - @ViewBag.CurrentInfo.CurrentIndustry.Name in @ViewBag.CurrentInfo.CurrentPlace.City.Name, @ViewBag.CurrentInfo.CurrentPlace.State.Abbreviation</title>
<link href="@Url.Content("~/Content/views/dashboard/index.css")?@SizeUp.Core.Web.CacheBuster.Buster" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Content/widget/views/dashboard/index.css")?@SizeUp.Core.Web.CacheBuster.Buster" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Content/widget/views/dashboard/print.css")?@SizeUp.Core.Web.CacheBuster.Buster" rel="stylesheet" type="text/css" media="print" />

<script type="text/javascript" src="http://api.@SizeUp.Core.Web.WebContext.Current.Domain/js/?apikey=@System.Configuration.ConfigurationManager.AppSettings["SizeUpAPI"]&wt=@ViewBag.WidgetToken&callback=apiLoaded&@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?key=@System.Configuration.ConfigurationManager.AppSettings["GoogleAPI"]&sensor=false"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/thirdParty/raphael-min.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/thirdParty/jquery.ba-bbq.min.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/thirdParty/mustache.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/thirdParty/tinycolor-min.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>

<script type="text/javascript" src="@Url.Content("~/Scripts/core/templates.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/util/numbers/format.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>

<script type="text/javascript" src="@Url.Content("~/Scripts/maps/heatmapColors.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/mapOptions.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/mapStyles.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/map.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/latLng.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/latLngBounds.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/overlay.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/heatmapOverlays.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/maps/legend.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>

<script type="text/javascript" src="@Url.Content("~/Scripts/controls/gauge.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/charts/barchart.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/charts/tableChart.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/charts/lineChart.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>

<script type="text/javascript" src="@Url.Content("~/Scripts/controls/toggleButton.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/controls/question.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/controls/flashBox.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/controls/industrySelector.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/controls/placeSelector.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/controls/promptBox.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>


<script type="text/javascript" src="@Url.Content("~/Scripts/views/dashboard/reportContainer.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/views/dashboard/revenue.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/views/dashboard/averageSalary.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/views/dashboard/yearStarted.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/views/dashboard/employees.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/views/dashboard/costEffectiveness.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/views/dashboard/revenuePerCapita.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/views/dashboard/turnover.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/views/dashboard/healthcareCost.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/views/dashboard/workersComp.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>

<script type="text/javascript" src="@Url.Content("~/Scripts/views/shared/signin.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>

<script type="text/javascript" src="@Url.Content("~/Scripts/views/dashboard/dashboard.js")?@SizeUp.Core.Web.CacheBuster.Buster"></script>

}


<div id="dashboard" class="hidden">
    <div class="headerWrapper">
        <h1 class="heading">
            <span>Compare your business to the competition in the</span>
           
            <input type="text" id="industryBox" data-prompt="enter an industry" class="hidden selectBox" />
            <a href="javascript:void(0);" id="changeIndustry" class="changeLink">@ViewBag.CurrentInfo.CurrentIndustry.Name</a>

            <span>industry in </span>


            <input type="text" id="placeBox" data-prompt="enter a city" class="hidden selectBox" />
            <a href="javascript:void(0);" id="changePlace" class="changeLink">@ViewBag.CurrentInfo.CurrentPlace.City.Name, @ViewBag.CurrentInfo.CurrentPlace.State.Abbreviation</a>

        </h1>
    </div>
        <div id="revenue" class="report">
        @Html.Partial("Revenue")
        </div>

        <div id="yearStarted" class="report">
        @Html.Partial("YearStarted")
        </div>

        <div id="salary" class="report">
        @Html.Partial("AverageSalary")
        </div>

        @if ((HttpContext.Current.User.Identity.IsAuthenticated || SizeUp.Core.API.APIContext.Current.WidgetPermissions.SigninOptional))
        {
        <div id="employees" class="report">
        @Html.Partial("Employees")
        </div>

        <div id="costEffectiveness" class="report">
        @Html.Partial("CostEffectiveness")        
        </div>

        <div id="revenuePerCapita" class="report">
        @Html.Partial("RevenuePerCapita")               
        </div>

        <div id="turnover" class="report">
        @Html.Partial("Turnover")                    
        </div>

        <div id="healthcareCost" class="report">
        @Html.Partial("HealthcareCost")                 
        </div>

        <div id="workersComp" class="report">
        @Html.Partial("WorkersComp")              
        </div>
        }
        else
        {
    
        <div id="employees" class="report disabled">
            <div class="header">
                <div class="icon"></div>
                <h2>Employees</h2>
                <span class="hint">Number of full-time equivalent employees</span>
                <p class="message"><a class="quickSignin" href="javascript:void(0);">Sign in</a> to view this report.</p>
            </div>
            <div class="body">
                @Html.Partial("Signin")
            </div>
        </div>

        <div id="costEffectiveness" class="report disabled">
            <div class="header">
                <div class="icon"></div>
                <h2>Cost Effectiveness</h2>
                <span class="hint">Revenue per employee divided by worker salary</span>
                <p class="message"><a class="quickSignin" href="javascript:void(0);">Sign in</a> to view this report.</p>
            </div>
            <div class="body">
                @Html.Partial("Signin")
            </div>
        </div>

        <div id="revenuePerCapita" class="report disabled">
            <div class="header">
                <div class="icon"></div>
                <h2>Revenue Per Capita</h2>
                <span class="hint">Revenue generated per community resident</span> 
                <p class="message"><a class="quickSignin" href="javascript:void(0);">Sign in</a> to view this report.</p>
            </div>     
            <div class="body">
                @Html.Partial("Signin")
            </div>  
        </div>

        <div id="turnover" class="report disabled">
            <div class="header">
                <div class="icon"></div>
                <h2>Local Turnover</h2>
                <span class="hint">Percentage of workers newly hired</span>  
                <p class="message"><a class="quickSignin" href="javascript:void(0);">Sign in</a> to view this report.</p>
            </div>   
            <div class="body">
                @Html.Partial("Signin")
            </div>      
        </div>

        <div id="healthcareCost" class="report disabled">
            <div class="header">
                <div class="icon"></div>
                <h2>Healthcare Cost</h2>
                <span class="hint">Annual healthcare premium per employee</span> 
                <p class="message"><a class="quickSignin" href="javascript:void(0);">Sign in</a> to view this report.</p>
            </div>
            <div class="body">
                @Html.Partial("Signin")
            </div>
        </div>

        <div id="workersComp" class="report disabled">
            <div class="header">
                <div class="icon"></div>
                <h2>Workers' Compensation</h2>
                <span class="hint">Premium per employee (per $100 of payroll)</span>  
                <p class="message"><a class="quickSignin" href="javascript:void(0);">Sign in</a> to view this report.</p>
            </div>
            <div class="body">
                @Html.Partial("Signin")
            </div>
        </div>  
        }

        <div id="sessionLoadedBox" class="flash hidden">
            <div class="info">
                <p>Your previously entered values for this city and industry have been loaded.</p>
            </div>
        </div>


    <a href="javascript:void(0);" id="summaryView" data-toggleText="Detailed View">Summary View</a>
</div>


@section scripts{

<script type="text/javascript">
    var done = function(){
        var opts = {
            currentInfo: @Html.Raw(ViewBag.CurrentInfoJSON),
            isAuthenticated: @((HttpContext.Current.User.Identity.IsAuthenticated || SizeUp.Core.API.APIContext.Current.WidgetPermissions.SigninOptional) ? "true" : "false")
            };
            var driver = new sizeup.views.dashboard.dashboard(opts);
        };

    var notifier = new sizeup.core.notifier(done);
    var apiLoaded = notifier.getNotifier();
    var doc = notifier.getNotifier();
    $(document).ready(doc);
</script>
}